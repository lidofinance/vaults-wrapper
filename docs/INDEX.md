
# Attempt to describe the system

## Navigation

- **[INDEX.md](./INDEX.md)** - Provides an overview of other docs and contains other descriptions.
- **[ACL-UPGRADABILITY.md](./ACL-UPGRADABILITY.md)** - Documents actors, roles, permissions, and control levers within the system. Details who can do what (user actions, system actions, administrative permissions).
- **[INVARIANTS.md](./INVARIANTS.md)** - Catalogs 32 critical security and accounting invariants that must be maintained for system correctness. Foundation for test plan design and attack surface analysis.
- **[INVARIANTS-another.md](./INVARIANTS-another.md)** - Complements main invariants with additional property checks for deposits, transfers, minting, and overall accounting constraints.
- **[EDGE-STATES.md](./EDGE-STATES.md)** - Describes regular operational flows, feedback loops, and extreme system states (e.g., key loss, large withdrawal queues). Identifies incentivized actors and preconditions for each state.
- **[TESTS-PLAN.md](./TESTS-PLAN.md)** - Describes the test plan for the system. It is supposed to be derived from invariants and edge states files and be an intermediate between the higher level description of system properties and tests implementation.

## Rules

[INDEX.md](./INDEX.md) contains description of stocks of the system (section [Stocks](##Stocks)). In description of invariants and states and loops reference the stock when appropriate.

## Purpose

- Provide a tokenized position (STV) for assets in a Lido V3 StakingVault.
- Allow users to borrow stETH/wstETH against STV while keeping vault‑level solvency.
- Absorb Lido’s staking dynamics (rebases, slashing, exits) while keeping user‑level risk bounded via LTV, liquidation, and loss socialization caps.
- Preserve safe exit for users even in stressed validator / oracle conditions, via withdrawal queue and emergency controls.

## Scope

### Docs

- separate by reader:
  - actors, roles, levers, ACL
    - where it goes?
  - invariants, security properties
    - to scaffold test plan on top level
  - test plan
  - extreme states and mitigations
    - used for test plan
    - just put to repo as docs
  - top-level (for arwer)
  - docs for immunefy (same as in repo)

- for us:
  - for test plan
  - SPEC
- for NO https://github.com/lidofinance/docs/blob/v3-docs-update/run-on-lido/stvaults/building-guides/pooled-staking-product.md
  - how to deploy a pool
  - how to maintain a pool
  - how to deploy UI
- for partner protocols who build on top of Lido
  - for strategy developers
- for security assestors? are anybody 'd like to evaludate wrapper?
- docs.lido.fi: general description, router for in-depth tutorials

### CLI

### Lido alerting

TODO

### On-chian

#### Inside

##### Wrapper Layer

- Factory: Deploys new StvPool / StvStETHPool / StvStETHPool + GGVStrategy / StvStETHPool + arbitrary strategy.
- StvPool: Base ERC20 token implementation (STV).
- StvStETHPool: Extended pool with stETH borrowing & rebalancing logic.
- Withdrawal Queue: Manages exit requests, delays, and finalization.
- Distributor: Handles reward distribution (if applicable).
- AllowList: Manages deposit permissions (optional).
- TimelockController: Admin of the StvPool and WithdrawalQueue proxies.

#### Strategy Layer

- GGVStrategy: Specific GGV strategy implementation.
- Arbitrary strategy (follows `IStrategy`): Generic interface.

#### On the edge

- Dashboard: The owner/controller of the StakingVault.
- StakingVault: Holds the ETH and Validator credentials (0x02...).
-
- NO's validator lifecycle ?

#### Outside

- Lido V3 (Vaults)
- Lido V2
  - Lido Oracle reports
  - stETH / wstETH token
- Ethereum Network
  - Execution layer
    - (Gas, Block time, Fusaka TX limit, ...)
  - Consensus Layer
    - Validators status (Active, Exited, Slashed).
    - Rewards/Penalties skimming.
- Points / Rewards:
  - Off-chain or on-chain incentives obtained by NO

## Stocks

These are the things that build up over time and stick around until something changes them.

⚠️ Proxy, OpenZeppelin ACL, features are not included.

| Stock (State Variable)                                                          | Contract          | Type                                                                                        | Inflow                                                                                                                                                                                                  | Outflow                                                                                                                                                                                                                        | Description                                                                                                                                                  |
| :------------------------------------------------------------------------------ | :---------------- | :------------------------------------------------------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                                                 |                   |                                                                                             |                                                                                                                                                                                                         |                                                                                                                                                                                                                                |                                                                                                                                                              |
| **Per pool**                                                                    |                   |                                                                                             |                                                                                                                                                                                                         |                                                                                                                                                                                                                                |                                                                                                                                                              |
| `stv_supply`                                                                    | `StvPool`         | `uint256`                                                                                   | `StvPool.initialize`<br>`StvPool.depositETH`<br>`StvStETHPool.depositETHAndMintStethShares`<br>`StvStETHPool.depositETHAndMintWsteth`                                                                   | `WithdrawalQueue.burnStvForWithdrawalQueue`<br>`StvStETHPool.rebalanceMintedStethSharesForWithdrawalQueue`                                                                                                                     | `totalSupply`. Total supply of the STV (Staking Vault) token.                                                                                                |
| `stv_of_wq`                                                                     | `StvPool`         | `uint256`                                                                                   | `StvPool.transferFromForWithdrawalQueue`<br>`StvStETHPool.transferFromWithLiabilityForWithdrawalQueue`                                                                                                  | `StvPool.burnStvForWithdrawalQueue`                                                                                                                                                                                            | `balanceOf(WITHDRAWAL_QUEUE)`. STV balance held by the WithdrawalQueue contract for pending withdrawal requests.                                             |
| `assets_pool_total` _computed_                                                  | `StvPool`         | `uint256`                                                                                   | `StvPool.depositETH`<br>`StvPool.receive()`<br>`StvStETHPool.depositETHAndMintStethShares`<br>`StvStETHPool.depositETHAndMintWsteth`<br>Vault rewards/rebases (oracle reports)                          | `WithdrawalQueue.finalize` (via `burnStvForWithdrawalQueue`)<br>Vault slashing/penalties (oracle reports)                                                                                                                      | `totalAssets`. Total assets in the pool computed from vault value plus exceeding minted stETH (or minus unassigned liability).                               |
| `total_pool_minted_steth_shares`                                                | `StvStETHPool`    | `uint256`                                                                                   | `StvStETHPool.mintStethShares`<br>`StvStETHPool.mintWsteth`<br>`StvStETHPool.depositETHAndMintStethShares`<br>`StvStETHPool.depositETHAndMintWsteth`                                                    | `StvPool.rebalanceUnassignedLiability`<br>`StvStETHPool.burnStethShares`<br>`StvStETHPool.burnWsteth`<br>`StvStETHPool.rebalanceMintedStethSharesForWithdrawalQueue`                                                           | Current total stETH share liability across all users in the wrapper pool.                                                                                    |
| `liability_pool_unassigned`<br>_computed_                                       | `StvStETHPool`    | `uint256`                                                                                   | N/A (computed from `vault_liability_shares` and user liabilities)                                                                                                                                       | `StvPool.rebalanceUnassignedLiability`<br>`StvPool.rebalanceUnassignedLiabilityWithEther`                                                                                                                                      | `VaultLiability` - `TotalUserLiability`. Liability not assigned to any specific user.                                                                        |
| `liability_pool_exceeding`<br>_computed_                                        | `StvStETHPool`    | `uint256`                                                                                   | N/A (computed from `liability_pool_total` and `vault_liability_shares`)                                                                                                                                 |                                                                                                                                                                                                                                | Excess minted stETH over vault liability when rebalancing happens on StakingVault bypassing wrapper.                                                         |
|                                                                                 |                   |                                                                                             |                                                                                                                                                                                                         |                                                                                                                                                                                                                                |                                                                                                                                                              |
| **Per user**                                                                    |                   |                                                                                             |                                                                                                                                                                                                         |                                                                                                                                                                                                                                | _Variables changed during regular flows_                                                                                                                     |
| `stv_of`                                                                        | `StvPool`         | `address -> uint256`                                                                        | `StvPool.depositETH`<br>`StvPool.transfer`<br>`StvStETHPool.transferWithLiability`<br>`WithdrawalQueue.transferFromForWithdrawalQueue`<br>`WithdrawalQueue.transferFromWithLiabilityForWithdrawalQueue` | `StvPool.transfer`<br>`StvStETHPool.transferWithLiability`<br>`WithdrawalQueue.transferFromForWithdrawalQueue`<br>`WithdrawalQueue.transferFromWithLiabilityForWithdrawalQueue`<br>`WithdrawalQueue.burnStvForWithdrawalQueue` | ERC20 `balanceOf`. Per-account STV balances.                                                                                                                 |
| `unlocked_stv_of` _computed_                                                    | `StvStETHPool`    | `uint256`                                                                                   | N/A (computed from `balanceOf` and `mintedStethShares`)                                                                                                                                                 | N/A (computed)                                                                                                                                                                                                                 | `unlockedStvOf`. Amount of STV that can be unlocked if a specified amount of stETH shares is burned.                                                         |
| `assets_of` _computed_                                                          | `StvPool`         | `address -> uint256`                                                                        | `StvPool.depositETH`<br>`StvPool.receive()`<br>`StvPool.transfer`<br>`StvStETHPool.depositETHAndMintStethShares`<br>`StvStETHPool.depositETHAndMintWsteth`<br>`StvStETHPool.transferWithLiability`      | `StvPool.transfer`<br>`StvStETHPool.transferWithLiability`<br>`WithdrawalQueue.transferFromForWithdrawalQueue`<br>`WithdrawalQueue.transferFromWithLiabilityForWithdrawalQueue`                                                | `assetsOf`. Per-account assets computed from STV balance as proportional share of total assets.                                                              |
| `unlocked_assets_of` _computed_                                                 | `StvStETHPool`    | `uint256`                                                                                   | N/A (computed from `assetsOf` and `mintedStethShares`)                                                                                                                                                  | N/A (computed)                                                                                                                                                                                                                 | `unlockedAssetsOf`. Amount of assets that can be withdrawn if a specified amount of stETH shares is burned. Computed as assets minus required locked amount. |
|                                                                                 |                   |                                                                                             |                                                                                                                                                                                                         |                                                                                                                                                                                                                                |                                                                                                                                                              |
| `stv_allowance_user`                                                            | `StvPool`         | `address -> address -> uint256`                                                             | `StvPool.approve`<br>`StvPool.increaseAllowance`                                                                                                                                                        | `StvPool.decreaseAllowance`<br>`StvPool.transferFrom`                                                                                                                                                                          | ERC20 `allowance`. Approved spending limits for third-party spenders.                                                                                        |
| `liability_user`                                                                | `StvStETHPool`    | `address -> uint256`                                                                        | `StvStETHPool.mintStethShares`<br>`StvStETHPool.mintWsteth`<br>`StvStETHPool.depositETHAndMintStethShares`<br>`StvStETHPool.depositETHAndMintWsteth`                                                    | `StvStETHPool.burnStethShares`<br>`StvStETHPool.burnWsteth`<br>`StvStETHPool.forceRebalance`<br>`StvStETHPool.forceRebalanceAndSocializeLoss`<br>`WithdrawalQueue.transferFromWithLiabilityForWithdrawalQueue`                 | Current per-user stETH share liability in the wrapper pool.                                                                                                  |
| `is_healthy_user`<br>_computed_                                                 | `StvStETHPool`    | `bool`                                                                                      |                                                                                                                                                                                                         |                                                                                                                                                                                                                                | false if the forced rebalance threshold is breached                                                                                                          |
| `is_undercollateralized`<br>_computed_                                          |                   | `bool`                                                                                      |                                                                                                                                                                                                         |                                                                                                                                                                                                                                | has bad dept <br>If the target rebalance amount exceeds the liability itself, the user is undercollateralized                                                |
|                                                                                 |                   |                                                                                             |                                                                                                                                                                                                         |                                                                                                                                                                                                                                |                                                                                                                                                              |
| `wq_locked_stv`                                                                 | `WithdrawalQueue` | `mapping`                                                                                   | `WithdrawalQueue.requestWithdrawal`<br>`WithdrawalQueue.requestWithdrawalBatch`                                                                                                                         | `WithdrawalQueue.finalize`<br>`WithdrawalQueue.burnStvForWithdrawalQueue`                                                                                                                                                      | Portion of `requests.cumulativeStv` representing STV currently locked in the queue.                                                                          |
| `wq_requests`                                                                   | `WithdrawalQueue` | `mapping`                                                                                   | `WithdrawalQueue.requestWithdrawal`<br>`WithdrawalQueue.requestWithdrawalBatch`                                                                                                                         | `WithdrawalQueue.finalize`                                                                                                                                                                                                     | `requests`. Details of each withdrawal request (owner, amount, status).                                                                                      |
| `wq_requests_by_owner`                                                          | `WithdrawalQueue` | `address -> set<uint256>`                                                                   | `WithdrawalQueue.requestWithdrawal`<br>`WithdrawalQueue.requestWithdrawalBatch`                                                                                                                         | `WithdrawalQueue.finalize`<br>`WithdrawalQueue.claimWithdrawal`<br>`WithdrawalQueue.claimWithdrawalBatch`                                                                                                                      | `requestsByOwner`. Per-user index of withdrawal request IDs.                                                                                                 |
| `wq_counters`                                                                   | `WithdrawalQueue` | `uint128 lastRequestId`<br>`uint128 lastFinalizedRequestId`<br>`uint96 lastCheckpointIndex` | `WithdrawalQueue.requestWithdrawal`<br>`WithdrawalQueue.requestWithdrawalBatch`<br>`WithdrawalQueue.finalize`                                                                                           | N/A (monotonic counters)                                                                                                                                                                                                       | `lastRequestId`, `lastFinalizedRequestId`, `lastCheckpointIndex` track queue progress.                                                                       |
| `wq_total_locked_assets`                                                        | `WithdrawalQueue` | `uint96`                                                                                    | `WithdrawalQueue.finalize`                                                                                                                                                                              | `WithdrawalQueue.claimWithdrawal`<br>`WithdrawalQueue.claimWithdrawalBatch`                                                                                                                                                    | `totalLockedAssets`. ETH locked in the withdrawal queue available for claiming.                                                                              |
| `wq_checkpoints`                                                                | `WithdrawalQueue` | `mapping`                                                                                   | `WithdrawalQueue.finalize`                                                                                                                                                                              | N/A                                                                                                                                                                                                                            | `checkpoints`. Snapshots of STV and stETH share rates for finalized ranges.                                                                                  |
| `distributor_claimed`                                                           | `Distributor`     | `mapping`                                                                                   | `Distributor.claim`                                                                                                                                                                                     | N/A (cumulative)                                                                                                                                                                                                               | `claimed`. Tracks amount of tokens claimed by each user per token.                                                                                           |
| `ggv_user_call_forwarder`                                                       | `GGVStrategy`     | `address -> address`                                                                        | `GGVStrategy.supply`<br>`GGVStrategy.requestExitByWsteth`<br>`GGVStrategy.requestWithdrawalFromPool`<br>`GGVStrategy.burnWsteth`<br>`GGVStrategy.recoverERC20`                                          | N/A                                                                                                                                                                                                                            | `userCallForwarder`. User address -> `StrategyCallForwarder` address.                                                                                        |
|                                                                                 |                   |                                                                                             |                                                                                                                                                                                                         |                                                                                                                                                                                                                                |                                                                                                                                                              |
| **Lido Core (V2 + V3)**                                                         |                   |                                                                                             |                                                                                                                                                                                                         |                                                                                                                                                                                                                                | _Stocks in Lido Core V2 contracts (stETH, wstETH) and Lido V3 Vaults layer._                                                                                 |
| `vault_total_value`                                                             | `VaultHub`        | `uint256`                                                                                   | `VaultHub.applyVaultReport`                                                                                                                                                                             | `VaultHub.applyVaultReport`                                                                                                                                                                                                    | `VaultRecord.report.totalValue` (+ `inOutDelta`). Effective ETH value of a vault.                                                                            |
| `vault_liability_shares`                                                        | `VaultHub`        | `uint96`                                                                                    | `VaultHub.mintShares`, `VaultHub.applyVaultReport`, `VaultHub.socializeBadDebt`                                                                                                                         | `VaultHub.burnShares`, `VaultHub.applyVaultReport`, `VaultHub.internalizeBadDebt`                                                                                                                                              | `VaultRecord.liabilityShares`. stETH-share liability of a vault to Core Pool.                                                                                |
| `vault_max_liability_shares`                                                    | `VaultHub`        | `uint96`                                                                                    | `VaultHub.applyVaultReport`                                                                                                                                                                             | `VaultHub.applyVaultReport`                                                                                                                                                                                                    | `VaultRecord.maxLiabilityShares`. Peak liability shares used for reserve locking.                                                                            |
| `vault_redemption_shares`                                                       | `VaultHub`        | `uint128`                                                                                   | `VaultHub.setLiabilitySharesTarget`                                                                                                                                                                     | `VaultHub.applyVaultReport`, `VaultHub.burnShares`                                                                                                                                                                             | `VaultRecord.redemptionShares`. Shares earmarked for Lido Core redemptions.                                                                                  |
| `vault_cumulative_lido_fees`                                                    | `VaultHub`        | `uint128`                                                                                   | `VaultHub.applyVaultReport`                                                                                                                                                                             | N/A (cumulative)                                                                                                                                                                                                               | `VaultRecord.cumulativeLidoFees`. Total protocol fees accrued on a vault.                                                                                    |
| `vault_settled_lido_fees`                                                       | `VaultHub`        | `uint128`                                                                                   | `VaultHub.settleLidoFees`                                                                                                                                                                               | N/A (cumulative)                                                                                                                                                                                                               | `VaultRecord.settledLidoFees`. Portion of fees already paid to treasury.                                                                                     |
| `vault_bad_debt_to_internalize`                                                 | `VaultHub`        | `uint256`                                                                                   | `VaultHub.internalizeBadDebt`                                                                                                                                                                           | `VaultHub.decreaseInternalizedBadDebt`                                                                                                                                                                                         | `badDebtToInternalize`. Shares of bad debt to be socialized as protocol loss.                                                                                |
| `vault_minimal_reserve`                                                         | `VaultHub`        | `uint128`                                                                                   | `VaultHub.connectVault`, `VaultHub.applyVaultReport`                                                                                                                                                    | `VaultHub.applyVaultReport`                                                                                                                                                                                                    | `VaultRecord.minimalReserve`. Minimum extra ETH that must remain locked per vault.                                                                           |
| `vault_assets`                                                                  | `StakingVault`    | `uint256`                                                                                   | `StakingVault.fund`, Beacon rewards                                                                                                                                                                     | `StakingVault.withdraw`, `StakingVault.depositToBeaconChain`, validator exits                                                                                                                                                  | `address(this).balance`. Total ETH held by a specific staking vault.                                                                                         |
| `vault_staged_balance`                                                          | `StakingVault`    | `uint256`                                                                                   | `StakingVault.stage`                                                                                                                                                                                    | `StakingVault.depositFromStaged`, `StakingVault.unstage`                                                                                                                                                                       | `stagedBalance`. ETH staged for future validator activations.                                                                                                |
| Fee Leftover                                                                    | `Dashboard`       | `uint128`                                                                                   | `Dashboard.voluntaryDisconnect` (via `_collectFeeLeftover`)                                                                                                                                             | `Dashboard.recoverFeeLeftover`                                                                                                                                                                                                 | `feeLeftover`. Node operator fees collected when the vault is disconnected.                                                                                  |
|                                                                                 |                   |                                                                                             |                                                                                                                                                                                                         |                                                                                                                                                                                                                                |                                                                                                                                                              |
| `steth_total_supply`                                                            | `Lido (stETH)`    | `uint256`                                                                                   | `Lido.submit`, `Lido.mintShares`, Oracle reward application<br>`StvStETHPool.depositETHAndMintStethShares`                                                                                              | `Lido.burnShares`, withdrawal queue redemptions, negative rebase                                                                                                                                                               | ERC20 `totalSupply` of stETH across Core Pool and stVault-backed positions.                                                                                  |
| `steth_total_shares`                                                            | `Lido (stETH)`    | `uint256`                                                                                   | `Lido.submit`, `Lido.mintShares`                                                                                                                                                                        | `Lido.burnShares`                                                                                                                                                                                                              | Internal `totalShares` backing all stETH balances.                                                                                                           |
| `steth_approve_of_pool_for_dashboard`<br>`wsteth_approve_of_pool_for_dashboard` |                   |                                                                                             | `StvStETHPool.initialize`                                                                                                                                                                               |                                                                                                                                                                                                                                | `STETH.approve(address(DASHBOARD), type(uint256).max);`<br>`WSTETH.approve(address(DASHBOARD), type(uint256).max);`                                          |
| `wsteth_total_supply`                                                           | `wstETH`          | `uint256`                                                                                   | `wstETH.wrap` (stETH -> wstETH)<br>`StvStETHPool.depositETHAndMintWsteth`                                                                                                                               | `wstETH.unwrap` (wstETH -> stETH)                                                                                                                                                                                              | ERC20 `totalSupply` of non-rebasing wstETH.                                                                                                                  |
|                                                                                 |                   |                                                                                             |                                                                                                                                                                                                         |                                                                                                                                                                                                                                |                                                                                                                                                              |
| **Administrative State**                                                        |                   |                                                                                             |                                                                                                                                                                                                         |                                                                                                                                                                                                                                | _Variables changed seldomly, requiring special permissions_                                                                                                  |
| Allow List                                                                      | `AllowList`       | `mapping`                                                                                   | `AllowList.addToAllowList`                                                                                                                                                                              | `AllowList.removeFromAllowList`                                                                                                                                                                                                | Addresses with `DEPOSIT_ROLE` allowed to deposit when allowlist is enabled.                                                                                  |
| `pool_rr`, `pool_force_rebalance_rr`                                            | `StvStETHPool`    | `uint16`, `uint16`                                                                          | `StvStETHPool.initialize`<br>`StvStETHPool.syncVaultParameters`                                                                                                                                         | `StvStETHPool.syncVaultParameters`                                                                                                                                                                                             | `reserveRatioBP`. Target ratio of collateral to debt.<br>`forcedRebalanceThresholdBP`. Health threshold (in BP) at which positions must be force-rebalanced. |
| Max Loss Socialization                                                          | `StvStETHPool`    | `uint16`                                                                                    | `StvStETHPool.setMaxLossSocializationBP`                                                                                                                                                                | `StvStETHPool.setMaxLossSocializationBP`                                                                                                                                                                                       | `maxLossSocializationBP`. Max basis points of loss that can be socialized.                                                                                   |
| Merkle Root                                                                     | `Distributor`     | `bytes32`                                                                                   | `Distributor.setMerkleRoot`                                                                                                                                                                             | Overwritten                                                                                                                                                                                                                    | `root`. Root of the Merkle tree for reward distribution.                                                                                                     |
| IPFS CID                                                                        | `Distributor`     | `string`                                                                                    | `Distributor.setMerkleRoot`                                                                                                                                                                             | Overwritten                                                                                                                                                                                                                    | `cid`. IPFS Content Identifier for the distribution data.                                                                                                    |
| Supported Tokens                                                                | `Distributor`     | `Set`                                                                                       | `Distributor.addToken`                                                                                                                                                                                  | N/A                                                                                                                                                                                                                            | `tokens`. Set of tokens supported for distribution.                                                                                                          |
| Distribution Last Processed Block                                               | `Distributor`     | `uint256`                                                                                   | `Distributor.setMerkleRoot`                                                                                                                                                                             | Overwritten                                                                                                                                                                                                                    | `lastProcessedBlock`. Block number used for off-chain indexing / monitoring.                                                                                 |
| Withdrawal Gas Cost Coverage                                                    | `WithdrawalQueue` | `uint64`                                                                                    | `WithdrawalQueue.setFinalizationGasCostCoverage`                                                                                                                                                        | Overwritten                                                                                                                                                                                                                    | `gasCostCoverage`. Per-request ETH compensation for finalizers inside checkpoints.                                                                           |
| Deployment Intermediate State                                                   | `Factory`         | `bytes32 -> uint256`                                                                        | `Factory.createPoolStart`                                                                                                                                                                               | `Factory.createPoolFinish` (marks finished), expiry                                                                                                                                                                            | `intermediateState`. Tracks per-deployment finish deadlines and completion markers.                                                                          |

## Alerting

Monitoring system.

TODO

## Other PoA (Points of Attention)

- Oracle Freshness:
  - Critical for all value calculations.
  - Stale oracle = System freeze (no deposits/withdrawals/rebalancing/minting).
- attaching multiple strategies
- Unassigned Liability:
  - "System Debt" that accumulates from rounding errors or socialized losses.
  - Must be cleared before certain operations (e.g., voluntary disconnect).
- Rounding Issues:
  - 1 wei discrepancies between `stETH` (shares) and `ETH` (assets).
- Socialized Losses:
  - The mechanism to handle insolvency at the user level to protect the vault level.
- UI:
  - How complex system states (e.g., "Queued", "Claimable", "Rebalancing") are shown to users.
  - Warning users about Stale Oracle state.
- Initial user expectations: STV behaves as ERC-20 token, can withdraw
- APR/APY calculation
- cli
